# LF-HybridNet
Learning Complementary-View and Spatial-AngularInformation for Light Field Image Super-Resolution


## Results
We share the pre-trained models and the SR LF images generated by our LF-HybridNet model for 2x and 4x LF spatial SR, which are avaliable at (https://drive.google.com/drive/folders/1u1KE9PbQgUBLrQAr0GpW9eECVkVAVxA0?usp=drive_link)

## Code


### Dependencies
* Python 3.6
* Pyorch 1.3.1 + torchvision 0.4.2 + cuda 92
* Matlab

This code is built up on the [Basic-LFSR](https://github.com/ZhengyuLiang24/BasicLFSR). Please go to orginal code for more guideline information. 

### Dataset
We use the processed data by [LF-DFnet](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9286855), including EPFL, HCInew, HCIold, INRIA and STFgantry datasets for training and testing. Please download the dataset in the official repository of [LF-DFnet](https://github.com/YingqianWang/LF-DFnet).

### Prepare Training and Test Data
* To generate the training data, please first download the five datasets and run:
  ```matlab
  Generate_Data_for_Training.m
* To generate the test data, run:
  ```matlab
  Generate_Data_for_Test.m
### Train
* Run:
  ```python
  python train.py  --model_name LF-HybridNet --angRes 5 --scale_factor 4 --n_groups 10 --n_blocks 5 --channels 64  --crop_test_method 3  
### Test
* Run:
  ```python
  python test.py --model_name LF-HybridNet --angRes 5 --upscale_factor 4 --n_groups 10 --n_blocks 5 --channels 64  --crop_test_method 3 --self_ensemble True  --model_path [pre-trained dir]
  
  
  
## Citation
If you find this work helpful, please consider citing the following papers:<br> 
```Citation
@Article{vinh2023-lfsr,
  author  = {Duong, V. V. and Nguyen, T. H. and Yim, J. and Jeon, B.},
  journal = {IEEE Trans. Compuational Imaging},
  title   = {Light Field Image Super-Resolution Network via Joint Spatial-Angular and Epipolar Information},
  year    = {2023},
}
```
```Citation
@InProceedings{NTIRE2023-LFSR,
  author    = {Wang, Yingqian and Wang, Longguang and Liang, Zhengyu and Yang, Jungang and Timofte, Radu and Guo, Yulan},
  title     = {NTIRE 2023 Challenge on Light Field Image Super-Resolution},
  booktitle = {CVPRW},
  year      = {2023},
}
```
## Acknowledgement
Our work and implementations are inspired and based on the following projects: <br> 
[Basic-LFSR](https://github.com/ZhengyuLiang24/BasicLFSR)<br> 
[LF-DFnet](https://github.com/YingqianWang/LF-DFnet)<br> 
[LF-InterNet](https://github.com/YingqianWang/LF-InterNet)<br>
We sincerely thank the authors for sharing their code and amazing research work!

## Contact
if you have any question, please contact me through email csr_20010517@163.com


